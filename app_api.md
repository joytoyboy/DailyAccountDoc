## 与服务的API接口设计

### 统一请求头

各接口中在请求header中包含统一的与接口无关的数据，如设备类型、设备ID等。  


| 名称          |说明       |类型   |必填| 备注|
| :------------|:---------|:--:|:----:|:---|
| UUID        |设备识别码   |字符串 |是  |     |
| AppVer      | APP版本     |数值   |是  |     |
| OSType      | 系统类型    |数值   |否  |1：安卓，2：iPhone, 3: iPad |
| OSVer       | 操作系统版本|字符串 |否  |     |
| token       | 令牌        |字符串 |否  |用户登录后，发起的请求都带有此值。登录前可以为空。 |


### 统一返回结果

返回结果为json数据，任何一个接口的返回数据都有三部分组成：


| 名称          |说明       |类型| 备注|
| :------------ |:----------|:--:|:----|
| code        |错误码     |数值||
| message     |错误描述   |字符串 ||
| data        |返回的数据对象   |对象 ||

	
```
{
	"code": 0,
	"message": "",
	"data": {
	}
}
``` 


- 错误码定义

| code  |message|
| :-----|:---|
| 1     |成功|
| 0     |未知错误|
| -1     |未登录|
| 其它值 |由各接口自行定义|


### 登录

| **接口**      | login.html |
| :------------ |:-----------|
| **Method**    |post |


  - **请求参数**

| 名称          |说明       |必填| 备注|
| :------------ |:----------|:--:|:----|
| name          |用户名     |是  |2-20位字符，唯一 |
| pwd           | 密码      |是  |6-20位数字字符组合|


- **返回结果**

以下只描述data中的返回结果。

``` json
{
	"name": zhangsan
	"token": 01234567890123456789012345678901
}
``` 

- **返回结果说明**  

| 名称          |说明       |类型| 备注|
| :------------ |:----------|:--:|:----|
| name        |用户名，和传入值相同。 |字符串||
| token     |访问令牌   |字符串 ||


### 注册

| **接口**      | reg.html |
| :------------ |:-----------|
| **Method**    |post |


  - **请求参数**

| 名称          |说明       |必填| 备注|
| :------------ |:----------|:--:|:----|
| name        |用户名     |是  |和login接口相同 |
| pwd           | 密码      |是  |和login接口相同|
| nickname      | 昵称      |否  |默认和name相同|


- **返回结果**

无。


### 修改密码

| **接口**      | modifypwd.html |
| :------------ |:-----------|
| **Method**    |post |


  - **请求参数**

| 名称          |说明       |必填| 备注|
| :------------ |:----------|:--:|:----|
| oldPwd           | 原密码    |是  |6-20位数字字符组合|
| newPwd           | 新密码    |是  |6-20位数字字符组合|


- **返回结果**

无。


### 找回密码

暂不实现。



### 退出登录

| **接口**      | logout.html |
| :------------ |:-----------|
| **Method**    |post |


  - **请求参数**

无。

- **返回结果**

无。


### 添加用途
 表示这笔账是干什么用的。

| **接口**      | adduse.html |
| :------------ |:-----------|
| **Method**    |post |


  - **请求参数**

| 名称          |说明       |必填| 备注|
| :------------ |:----------|:--:|:----|
| name           | 用途    |是  |最多20字符|
| type           | 类型id    |是  |参见addaccount.html|
| beforeName     | 添加位置，添加到哪个用途之前 |否  |无则添加到最后|


- **返回结果**
新的的用途，及按用户排序返回此用户的所有用途列表。

``` json
{
    "newData": {
        "id": 10,
        "name": "应筹",
        "type": "支出",
        "typeId": 1,
    }
    "id": 10,
    "name": "应筹",
    "type": "支出",
    "typeId": 1,
    "list": [
        {"id": 1,
        "name": "衣",
        "type": "支出",
        "typeId": 1,
        },
        {"id": 2,
        "name": "食",
        "type": "支出",
        "typeId": 1,
        },
        {"id": 3,
        "name": "住",
        "type": "支出",
        "typeId": 1,
        },
    ]
}
``` 

- **返回结果说明**  

| 名称          |说明       |类型| 备注|
| :------------ |:----------|:--:|:----|
| newData        |新加用途|对象|
| newData.id        |新加用途的id |数值||
| newData.name     |用途名称   |字符串 ||
| newData.type     |账目类型   |字符串 ||
| list     |所有用途列表   |数组 ||
| list.id     |用途id   |数值 ||
| list.name     |用途名称   |字符串 ||
| list.type     |账目类型   |字符串 ||

### 获取用途列表
 此用户用途列表

| **接口**      | uselist.html |
| :------------ |:-----------|
| **Method**    |post |


  - **请求参数**
 无。

- **返回结果**
用户排序返回此用户的所有用途列表。

``` json
{
    "list": [
        {"id": 1,
        "name": "衣",
        "type": "支出",
        },
        {"id": 2,
        "name": "食",
        "type": "支出",
        },
        {"id": 3,
        "name": "住",
        "type": "支出",
        },
    ]
}
``` 

- **返回结果说明**  

| 名称          |说明       |类型| 备注|
| :------------ |:----------|:--:|:----|
| list     |所有用途列表   |数组 ||
| list.id     |用途id   |数值 ||
| list.name     |用途名称   |字符串 ||
| list.type     |账目类型   |字符串 ||

### 记账

增加一笔支收或收入记录。

| **接口**      | addaccount.html |
| :------------ |:-----------|
| **Method**    |post |


  - **请求参数**

| 名称          |说明       |必填| 备注|
| :------------ |:----------|:--:|:----|
| type          |类型id     |是  |1: 支出，2: 收入，3:取现 4: 存现 5: 借款，6: 还借款，7: 放款，8：放款收回 |
| time          |日期     |是  |时间戳，单位：秒 |
| desc          |描述     |是  |字符串，100字符以内 |
| moneyMode     |消费方式  |是  |1: 现金，2: 借记卡，3: 信用卡，4: 其它(如支付宝、油卡等） |
| use           | 用途      |是  |用途id|
| amount           | 金额      |是  |单位：分|


- **返回结果**

无。


### 账目表

获取账目表。

| **接口**      | addaccount.html |
| :------------ |:-----------|
| **Method**    |post |


  - **请求参数**

| 名称          |说明       |必填| 备注|
| :------------ |:----------|:--:|:----|
| type          |类型id     |是  |0: 所有，其它值: 同上 |
| from          |索引值     |否  |从第几个开始返回，缺省从第一个开始。 |
| count          |个数     |否  |返回的数量，缺省30个，-1：返回所有。 |
| sort     |排序关键字  |否  |缺省按日期降序。1: 日期，2: 用途，3: 金额 |
| sortDesc     |是否为降序  |否  |缺省升序。1: 降序 |
| startTime           | 开始时间      |否  |无则无开始时间|
| endTime           | 终止时间      |否  |无则无终止时间|


- **返回结果**

以下只描述data中的返回结果。

``` json
{
	"list": [
	    {"id": 1,
	    "type": 1,
	    "time": 123456,
	    "desc": "大衣一件",
	    "moneyMode": 3,
	    "use": 1},
	    {"id": 2,
	    "type": 2,
	    "time": "2016-05-11",
	    "desc": "发工资",
	    "moneyMode": 2,
	    "use": 1},
	]
}
``` 

- **返回结果说明**  

| 名称          |说明       |类型| 备注|
| :------------ |:----------|:--:|:----|
| list        |账目表。 |数组||
| list.id     |账目id   |数值 ||
| list.type     |类型id   |数值 ||
| list.time     |时间戳(秒)   |数值 ||
| list.desc     |描述   |字符串 ||
| list.moneyMode     |消费方式   |数值 ||
| list.use     |用途id   |数值 ||
